# İçindekiler

- [İsimlendirme Kuralları](#isimlendirme-kuralları)
- [Code Smell Nedir?](#code-smell-nedir)
- [Teknik Borç ve Code Refactor](#teknik-borç-ve-code-refactor)

# İsimlendirme Kuralları

- Bir dilin isimlendirme kurallarını öğrenmek istiyorsak: '**C# Naming Conventions**' şeklinde arama yapabiliriz.

- Değişkenleri, metotları, parametreleri vb. isimlendirirken kolaya kaçmamalıyız. Olabildiğince anlamlı ve açık bir şekilde isimlendirme yapmalıyız. Ayrıca kısaltma kullanımlarından kaçınmalıyız.

- Programlamada İngilizce kullanmak, Türkçe kullanımına göre çok daha avantajlıdır. Çünkü her alanda olduğu gibi global ölçekte standarttır. Ek olarak Türkçe'deki çekimler programlamaya yatkın değildir.

- Ayrıca geliştiriciler arasında ortak bir dil olmalı. ***'Getir'*** ve ***'Listele'*** şeklinde 2 farklı kullanım olursa sorunlar yaşanabilir. Buna **'Common Language - Ortak Dil'** denir. Ayrıca kendi yazdığımız kodlarda da bir standartımızı oluşturmalıyız. Eğer Türkçe yazıyorsak, bazı yerlerde ***'Getir'***, bazı yerlerde ***'Listele'*** yazmamalıyız. Bir standart belirleyip onun üzerinden devam etmeliyiz. İngilizce içinse örnek olarak ***'Get'*** veya ***'Take'*** ikilisinden birisini seçip (Burada ***'Get'***  kullanımı oldukça yaygındır.) onun üzerinden devam etmeliyiz.

- İsimlendirme kurallarında 2 adet yöntem vardır. Bu yöntemler değişken tanımlarken, fonksiyon tanımlarken vb. yerlerde kullanılır.

  1. **PascalCase:** Kelimelerin ilk harfleri büyük, diğer harfler küçük olacak şekilde yazılır. Örnek olarak: ```ListItems()```


  2. **camelCase:** Pascal Case ile aynıdır. Tek farkı ilk kelimenin ilk harfi de küçük yazılır. Örnek olarak: ```listItems()```

  - C# için bazı isimlendirme kurallarına bakarsak:
      - Metot isimleri için PascalCase kullanılır. (```GetItems()```)
      - Sınıf isimleri için PascalCase Kullanılır. (```Item```) 
      - Yerel değişkenler için camelCase kullanılır. (```numberOfItems```)
      - İnterface'ler için, interface isimlerinin başlarına 'I' harfi yazılır. (```IContentService```)

  &nbsp;

  - Java için bazı isimlendirme kurallarına bakarsak:
      - Metot isimleri için camelCase kullanılır. (```getItems()```)
      - Sınıf isimleri için PascalCase Kullanılır. (```Item```) 
      - Yerel değişkenler için camelCase kullanılır. (```numberOfItems```)
      - İnterface'ler için PascalCase kullanılır (```ContentService```)

  &nbsp;
  - Diğer diller ve üstteki 2 dil için daha detaylı isimlendirme kuralları için [buraya](https://github.com/ktaranov/naming-convention) tıklayabilirsiniz.

  &nbsp;

- Sınıf isimleri çoğul olamaz. Örnek olarak ```Products``` şeklinde bir tanımlama değil, ```Product``` şeklinde bir tanımlama olmalıdır. Bunun nedeni, sınıftan ```Product product = new Product()``` şeklinde bir nesne oluştururken tek bir nesne oluştururuz. Burada bir mantık hatası olmamalıdır. Ayrıca sınıf isimlerini çoğul tanımlarsak, veritabanı ile çalışma yaptığımızda veritabanındaki tablo isimleri ile sınıf isimleri karışabilir. Bunun önüne geçebilmek için isimlendirmelere dikkat etmeliyiz.

- Sınıflarda değişkenleri oluştururken ```constructor```'ların (yapıcı metotların) üst kısmında oluşturmaya dikkat etmeliyiz.

- Değişkenleri ```public``` yapmamız Encapsulation'a (kapsüllemeye) uygun olmayan durum oluşturur. Bu yüzden yapmamalıyız.

<br>

# Code Smell Nedir?

- Fonksiyonlarda parametre kullanımlarına dikkat etmeliyiz. Parametre sayısını olabildiğince az tutarak karmaşıklığı azaltmaya çalışırız. Örnek olarak bir kullanıcının bütün bilgilerini ***'primitive type'*** olarak ```(int,string vb.)``` fonksiyona göndermemeliyiz. 
Bir kullanıcı nesnesi oluşturup, o nesneyi göndermemiz daha sağlıklı olacaktır. 

```cs
public void AddCustomer(int id, string firstName, string lastName, string identityNumber, int cityId){
    //Bu şekilde kullanmamalıyız.
}
```
```cs
public void AddCustomer(Customer customer){
    //Bu şekilde kullanmalıyız.
}
```


- Yazdığımız kodda dikkat etmemiz gereken diğer bir önemli kural ```if``` kullanımının suistimal edilmemesidir. Örnek olarak bir ehliyet sınavı sistemimiz olsun. Bu sınavda adayların sınav sonuçlarına göre ehliyet almaya hak kazanması veya kazanamaması durumlarını ölçmek istiyoruz. Burada ```if(ilkYardim >= 70 && motor >= 70)``` şeklinde ```if``` kullanmamızda bir sıkıntı yoktur. Farklı bir sistem düşünelim. Bir banka sisteminde çalışıyoruz. Sistem içerisinde A-B-C...-H şeklinde kredi tipleri olsun. Eğer bir müşterinin hangi kredi tipini kullanmak istediğini kontrol etmek için ```if(krediTipi = A)``` yazıp içerisinde A kredisi için kodları yazarsak,```if(krediTipi = B)``` yazıp içerisinde B kredisi için kodları yazarsak ve bu şekilde bütün kredi tipleri için if yazarsak bu durum bizi spagetti koda götürecektir. Bunu yapmamalıyız.

- Kodumuzun **spagetti kod** olmasınıı önlemek için hedefimiz: sistemde yapılacak bir değişiklikte, sistemin diğer kısımlarına yapılacak olan müdahalenin minimum olmasını sağlamak.

```cs
public void Main(string[], args){

    CustomerManager customerManager = new CustomerManager();
    
    customerManager.AddCustomer(
        // Id'ler otomatik artan olarak atanıyor. 
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123"
        });

    customerManager.AddCustomer(
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123", 
            CityId = 123 
            
            // Burada ekleme işlemi yaparken diğer eklemelerden farklı olarak cityId değerini de ekledik. Bunun için AddCustomer'da bir değişiklik yapmak zorunda kalmadık.

            // Bu şekilde kullandığımızda validation işlemlerinde de ayrı işlemler yapmamız gerekir. Bunu unutmamalıyız.
        });

    customerManager.AddCustomer(
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123"
        });

}
```


- Eğer kodumuzu rahat okunabilir halde tutarsak, kodumuz sürdürülebilir bir hale geçer.

- Yazdığımız kodda fonksiyonelliğe de dikkat etmeyliyiz. Eğer daha sonra farklı bir yerde de kullanmamız gerekeceğini düşündüğümüz bir kod bloğu farkedersek, o bloğu bir fonksiyon olarak tanımlayıp kullanılabilirliğini arttırmalıyız.

- Sınıf tanımlamalarında property'ler tanımlanırken ***Id*** ve ***Ferignkey***'ler diğer prop'ların üst kısmında tanımlanır. Bu standart olan kullanımdır.

```cs
class Customer {
    public int Id { get; set;}
    public int CityId { get; set;} // Foreign key
    
    public string FirstName { get; set;}
    public string LastName { get; set;}
    public string IdentityNumber { get; set;}
}
```

<br>

# Teknik Borç ve Code Refactor

- Acil bir durumda kodumuza bir şeyler eklememizin gerektiği bir senaryo düşünelim. O kadar acil ki katmanlı bir mimaride, kodumuzu ait olmaması gerken bir katmana yazıp hızlıca sonuç almak istiyoruz. "Şimdi buraya yazayım, sonra düzeltirim." dediğimiz duruma ***Teknik Borçlanma - Technical Debt*** diyoruz. Eğer böyle bir borçlanmaya gireceksek te sonrasında kendimizi koruyacak şekilde girmemiz gerekir. Yazdığımız kodun ***Refactor*** edilebilir bir kod olmasını sağlamamız gerekiyor.

``` cs 
class CustomerManager{
    
    public void AddCustomer(Customer customer){

        if( !String.IsNullOrEmpty(customer.FirstName) &&
            !String.IsNullOrEmpty(customer.LastName) &&
            !String.IsNullOrEmpty(customer.IdentityNumber))
        {
            Console.WriteLine("Eklendi");
            Console.WriteLine("Eklendi");
            Console.WriteLine("Eklendi");
        }
    }
}
```
- Eğer yukarıdaki gibi bir kod yazarsak, hatalı bir yazım yapmış oluruz. Çünkü doğrulama kodlarını ve iş kodlarını aynı fonksiyon içerisinde beraber yazdık. İlerleyen zamanlarda başka bir yerde doğrulama yapmak istersek ya da doğrulama yapmadan ekleme yapmak istersek gibi farklı senaryolarda sıkıntı yaşayacağız. "Şimdilik yazayım sonra düzelteceğim." dediğimiz zaman **Teknik Borçlanma** durumuna girmiş oluyoruz. Durumumuz gereği böyle bir kod yazmak zorundaysak o zaman şu şekilde yazmalıyız:
``` cs 
class CustomerManager{
    
    public void AddCustomer(Customer customer){

        if( String.IsNullOrEmpty(customer.FirstName) ||
            String.IsNullOrEmpty(customer.LastName) ||
            String.IsNullOrEmpty(customer.IdentityNumber))
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }

        Console.WriteLine("Eklendi");
        Console.WriteLine("Eklendi");
        Console.WriteLine("Eklendi");
    }
}
```

- Hala borçlu durumda olsak bile kodumuzun **Refactor** edilebilirliğini arttırmış olduk. Karmaşıklık seviyesini azalttık. Artık kodumuzu **Refactor** etmek istersek şu şekilde yazabiliriz:

```cs
class CustomerManager{
    
    public void AddCustomer(Customer customer){

        Vaildate(customer);
    
        Console.WriteLine("Eklendi");
    }

    private void Validate(Customer customer){
        
        if( String.IsNullOrEmpty(customer.FirstName) ||
            String.IsNullOrEmpty(customer.LastName) ||
            String.IsNullOrEmpty(customer.IdentityNumber))
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }
    }
}
```

- Kodumuz önceki halinden biraz daha iyi durumda fakat hala olması gerektiği gibi değil. Kodumuzu daha da iyi hale getirmek istersek bazı değişikliklere gitmemiz gerekiyor. Şu şekilde yazabiliriz.



```cs
public void Main(string[], args){

    CustomerManager customerManager = new CustomerManager();
    
    customerManager.AddCustomer(
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123"
        });

    // Burada diğer ekleme durumlarından farklı olarak "FirstName'in uzunluğu minimun 10 olmalı" şeklinde bir doğrulama koymamız gerektiğini düşünelim.
    customerManager.AddCustomerOtherBusiness(
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123", 
            CityId = 123 
        });

    customerManager.AddCustomer(
        new Customer 
        {
            FirstName = "Ahmet",
            LastName = "Sezgin",
            IdentityNumber = "123"
        });
}

class CustomerManager(){

    public void AddCustomer(Customer customer){

        ValidateFirstName(customer);
        ValidateLastName(customer);
        ValidateIdentityNumber(customer);

        CustomerDal customerDal = new CustomerDal();
        customerDal.Add(customer);

    }

        public void AddCustomerOtherBusiness(Customer customer){

        ValidateFirstName(customer);
        ValidateFirstNameLength(customer);
        ValidateLastName(customer);
        ValidateIdentityNumber(customer);

        CustomerDal customerDal = new CustomerDal();
        customerDal.Add(customer);

    }

    private void ValidateFirstName(Customer customer){
        
        if( String.IsNullOrEmpty(customer.FirstName))
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }
    }

    private void ValidateFirstNameLength(Customer customer){
        
        // OtherBusiness için yazdığımız ayrı doğrulama işlemi
        if(customer.FirstName.Length < 10)
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }
    }

    private void ValidateLastName(Customer customer){
        
        if( String.IsNullOrEmpty(customer.LastName))
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }
    }

    private void ValidateIdentityNumber(Customer customer){
        
        if( String.IsNullOrEmpty(customer.IdentityNumber))
        {
            throw new Exception("Doğrulama hatası yapıldı.");
        }
    }
}

class CustomerDal(){
    
    // Veri erişim katmanında asla iş kodu yazılmaz. Veriyi veritabanına eklemeye yönelik tek kod yazılabilir.
    public void Add(Customer customer){
        Console.WriteLine("Veritabanına eklendi");
    }
}

class Customer {
    public int Id { get; set;}
    public int CityId { get; set;} // Foreign key
    
    public string FirstName { get; set;}
    public string LastName { get; set;}
    public string IdentityNumber { get; set;}
}
```

- Artık sistem oldukça modüler hale geldi. Örnek olarak diyelim ki bir değişiklik yapmamız istendi. Sistemimizi yabancılar da kullanmaya başladı ve onların TC kimlik numaraları olmadığı için ```IdentityNumber``` doğrulaması yapmak istemiyoruz. Yani ```IdentityNumber``` kısmı artık boş olabilir. Yapacağımız tek şey ```Manager``` içerisindeki ```Add``` fonksiyonlarındaki ```ValidateIdentityNumber(customer);``` kısımları kaldırmak. Artık değişiklik yapılacağı zaman, yazdığımız koda müdahalemizi minimuma indirmeye başladık.

- Yukarıdaki sistem artık önceki hallerine göre oldukça iyi hale geldi. Artık daha da iyi hale getirmek istersek sisteme ```Fluent Validation``` ekleyeceğiz.

